<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What Happens When Open Is Called</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>WHAT HAPPENS WHEN OPEN() IS CALLED <span class="cursor"></span></h1>
            <p>> AXIOMATIC INVESTIGATION: PRE-SYSCALL EXECUTION PATH</p>
            <p>> TARGET: <span class="addr">LINUX x86_64</span></p>
        </header>

        <section class="step">
            <h2>01. CALCULATE RUNTIME BASE ADDRESS</h2>
            <div class="cmd-block">
FACT: libc.so.6 Start Address = <span class="addr">0x7ffff7c00000</span>
OFFSET: Beginning of file = <span class="addr">0x000000</span>
CALCULATION: <span class="addr">0x7ffff7c00000</span> + 0 = <span class="addr">0x7ffff7c00000</span>
            </div>
            <p class="output-block">MATCHES: info proc mappings output ✓</p>
        </section>

        <section class="step">
            <h2>02. CALCULATE STATIC OFFSET OF OPEN()</h2>
            <div class="cmd-block">
FACT: Runtime Address of open() = <span class="addr">0x7ffff7d1b150</span>
FACT: Base Address = <span class="addr">0x7ffff7c00000</span>
CALCULATION: <span class="addr">0x7ffff7d1b150</span> - <span class="addr">0x7ffff7c00000</span> = <span class="addr">0x11b150</span>
            </div>
            <p class="output-block">MATCHES: readelf -s libc.so.6 | grep open ✓</p>
        </section>

        <section class="step">
            <h2>03. CALCULATE GOT ENTRY ADDR (RIP-RELATIVE)</h2>
            <div class="cmd-block">
FACT: RIP at JMP (Next Instruction) = <span class="addr">0x55555555505a</span>
FACT: Offset from Machine Code (ff 25 76 2f 00 00) = <span class="addr">0x2f76</span>
CALCULATION: <span class="addr">0x55555555505a</span> + <span class="addr">0x2f76</span> = <span class="addr">0x555555557fd0</span>
            </div>
            <p class="output-block">MATCHES: objdump output ✓</p>
        </section>

        <section class="step">
            <h2>04. VERIFY GOT CONTENT</h2>
            <div class="cmd-block">
FACT: GOT Address = <span class="addr">0x555555557fd0</span>
FACT: Content at GOT Address = <span class="addr">0x00007ffff7d1b150</span>
VERIFICATION: <span class="addr">0x555555557fd0</span> -> <span class="addr">0x7ffff7d1b150</span>
            </div>
            <p class="output-block">MATCHES: Runtime Address from Step 02 ✓</p>
        </section>

        <section class="step">
            <h2>05. CALCULATE O_CREAT CHECK</h2>
            <div class="cmd-block">
FACT: User Flags (O_RDWR) = 2 = <span class="math">00000010</span>
FACT: O_CREAT Mask = 0x40 = <span class="math">01000000</span>
CALCULATION: <span class="math">00000010</span> & <span class="math">01000000</span> = 0
            </div>
            <p class="output-block">RESULT: Zero Flag Set. No Jump to Mode Logic. ✓</p>
        </section>

        <section class="step">
            <h2>06. THREAD SAFETY CHECK</h2>
            <div class="cmd-block">
FACT: __libc_single_threaded = 1 (True)
FACT: Comparison Value = 0 (False)
CALCULATION: 1 != 0 -> True
            </div>
            <p class="output-block">RESULT: JE (Jump Equal) does NOT jump. Fast Path taken. ✓</p>
        </section>

        <section class="step">
            <h2>07. TWO'S COMPLEMENT (AT_FDCWD)</h2>
            <div class="cmd-block">
FACT: AT_FDCWD = -100
CALCULATION: 100 = <span class="math">0x64</span>
INVERT BITS: ~0x64 = <span class="math">0xFFFFFF9B</span>
ADD 1: <span class="math">0xFFFFFF9B</span> + 1 = <span class="addr">0xFFFFFF9C</span>
            </div>
            <p class="output-block">MATCHES: mov $0xffffff9c,%edi instruction ✓</p>
        </section>

        <section class="step">
            <h2>08. SYSCALL NUMBER (OPENAT)</h2>
            <div class="cmd-block">
FACT: __NR_openat defined in asm/unistd_64.h
VALUE: 257 = <span class="addr">0x101</span>
            </div>
            <p class="output-block">MATCHES: mov $0x101, %eax instruction ✓</p>
        </section>
        
        <section class="step" style="border-color: #ff5555;">
            <h2 style="color: #ff5555;">FAILURE PREDICTIONS</h2>
            <div class="cmd-block" style="border-left-color: #ff5555;">
1. GOT OFFSET ERROR: If Step 03 is off by 1 byte -> <span class="addr">SEGFAULT</span> (Jumping to garbage).
2. BITMASK ERROR: If O_CREAT mask was 0x3 -> Result Non-Zero -> Logic Error (Reading garbage stack args).
            </div>
        </section>
    </div>
</body>
</html>